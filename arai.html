<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ARAI - Arduino Assistant</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #000;
      color: #eee;
      font-family: 'Inter', sans-serif;
    }

    .ambience-line {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, violet);
      background-size: 1000% 100%;
      animation: rgbFlow 30s linear infinite;
      z-index: 0;
    }

    @keyframes rgbFlow {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }

    #chat {
      max-width: 600px;
      margin: 80px auto;
      border: 1px solid #555;
      padding: 15px;
      border-radius: 8px;
      background-color: #111;
      position: relative;
      z-index: 1;
    }

    .message {
      margin-bottom: 15px;
      white-space: pre-wrap;
      font-family: monospace;
    }

    .bot {
      color: #6cf;
    }

    .user {
      color: #fc6;
      text-align: right;
    }

    button.option-btn {
      background-color: #333;
      color: white;
      border: none;
      border-radius: 20px;
      padding: 6px 12px;
      margin: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    button.option-btn:hover {
      background-color: #555;
    }

    .top-menu {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 2;
    }

    .top-menu a {
      color: #fff;
      text-decoration: none;
      background: #444;
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: bold;
    }

    .top-menu a:hover {
      background: #666;
    }
  </style>
</head>
<body>

<div class="ambience-line"></div>

<div class="top-menu">
  <a href="https://mehmetakifkaraman.github.io/" target="_blank">Main Menu</a>
</div>

<div id="chat"></div>

<script>
  const chat = document.getElementById('chat');
  const state = { step: 0, project: null };

  async function slowPrint(text, className = 'bot') {
    const messageElem = document.createElement('div');
    messageElem.className = 'message ' + className;
    chat.appendChild(messageElem);

    for (let i = 0; i < text.length; i++) {
      messageElem.textContent += text[i];
      await new Promise(r => setTimeout(r, 30));
      window.scrollTo(0, document.body.scrollHeight);
    }

    return messageElem;
  }

  function showUserMessage(text) {
    const userMsg = document.createElement('div');
    userMsg.className = 'message user';
    userMsg.textContent = text;
    chat.appendChild(userMsg);
    window.scrollTo(0, document.body.scrollHeight);
  }

  function createOptions(options) {
    const container = document.createElement('div');
    options.forEach(opt => {
      const btn = document.createElement('button');
      btn.textContent = opt.label;
      btn.className = 'option-btn';
      btn.onclick = () => {
        container.remove();
        handleUserInput(opt.value);
      };
      container.appendChild(btn);
    });
    chat.appendChild(container);
    window.scrollTo(0, document.body.scrollHeight);
  }

  async function handleUserInput(input) {
    showUserMessage(input);

    switch (state.step) {
      case 0:
        if (input === 'installed') {
          await slowPrint("Great! Let's continue. üéâ");
          state.step++;
          askProjectChoice();
        } else if (input === 'not_installed') {
          await slowPrint("You can download Arduino IDE here:\nhttps://www.arduino.cc/en/software üòä");
          await new Promise(r => setTimeout(r, 800));
          createOptions([{ label: "I installed it", value: "installed" }]);
        }
        break;

      case 1:
        if (['1', '2', '3', '4', '5'].includes(input)) {
          state.project = input;
          showProjectDetails(input);
        } else {
          await slowPrint("Please select a valid option.");
          askProjectChoice();
        }
        break;

      case 2:
        await slowPrint("Would you like to try another project?");
        state.step = 1;
        askProjectChoice();
        break;
    }
  }

  function askIdeStatus() {
    slowPrint("Hello! I'm ARAI ü§ñ Your Arduino project assistant.\n")
      .then(() => {
        return slowPrint("Is Arduino IDE installed on your computer?");
      })
      .then(() => {
        createOptions([
          { label: "Installed", value: "installed" },
          { label: "Not Installed", value: "not_installed" }
        ]);
      });
  }

  function askProjectChoice() {
    slowPrint("What would you like to do? Choose a number:\n1Ô∏è‚É£ Blink an LED\n2Ô∏è‚É£ Control LED with a button\n3Ô∏è‚É£ Measure temperature with DHT11\n4Ô∏è‚É£ Control a Servo Motor\n5Ô∏è‚É£ Display on LCD")
      .then(() => {
        createOptions([
          { label: "1Ô∏è‚É£ Blink an LED", value: "1" },
          { label: "2Ô∏è‚É£ Control LED with Button", value: "2" },
          { label: "3Ô∏è‚É£ Measure Temp with DHT11", value: "3" },
          { label: "4Ô∏è‚É£ Control Servo Motor", value: "4" },
          { label: "5Ô∏è‚É£ Use LCD Display", value: "5" }
        ]);
      });
  }

  async function showProjectDetails(choice) {
    const details = {
      "1": {
        materials: "Required components:\nüîπ Arduino Uno\nüîπ LED\nüîπ 220Œ© resistor\nüîπ Jumper wires\nüîπ Breadboard (optional)",
        steps: "Circuit:\n1Ô∏è‚É£ Connect LED long leg to pin 13\n2Ô∏è‚É£ Connect short leg through resistor to GND",
        code: [
          "// LED Blink Example",
          "int ledPin = 13;",
          "void setup() { pinMode(ledPin, OUTPUT); }",
          "void loop() { digitalWrite(ledPin, HIGH); delay(1000); digitalWrite(ledPin, LOW); delay(1000); }"
        ]
      },
      "2": {
        materials: "Required components:\nüîπ Arduino Uno\nüîπ LED\nüîπ 220Œ© resistor\nüîπ Button\nüîπ Jumper wires\nüîπ Breadboard",
        steps: "Circuit:\n1Ô∏è‚É£ Button to pin 2 and GND\n2Ô∏è‚É£ LED long leg to pin 13, short to GND via resistor",
        code: [
          "// LED with Button",
          "int ledPin = 13; int buttonPin = 2;",
          "void setup() { pinMode(ledPin, OUTPUT); pinMode(buttonPin, INPUT); }",
          "void loop() {",
          "  if (digitalRead(buttonPin) == HIGH) digitalWrite(ledPin, HIGH);",
          "  else digitalWrite(ledPin, LOW);",
          "}"
        ]
      },
      "3": {
        materials: "Required components:\nüîπ Arduino Uno\nüîπ DHT11 Sensor\nüîπ Jumper wires",
        steps: "Circuit:\n1Ô∏è‚É£ DHT VCC to 5V\n2Ô∏è‚É£ GND to GND\n3Ô∏è‚É£ Data to pin 2",
        code: [
          "// DHT11 Sensor Example",
          "#include <DHT.h>",
          "#define DHTPIN 2",
          "#define DHTTYPE DHT11",
          "DHT dht(DHTPIN, DHTTYPE);",
          "void setup() { Serial.begin(9600); dht.begin(); }",
          "void loop() {",
          "  float h = dht.readHumidity(); float t = dht.readTemperature();",
          "  if (isnan(h) || isnan(t)) { Serial.println(\"Failed to read\"); return; }",
          "  Serial.print(\"Humidity: \"); Serial.print(h);",
          "  Serial.print(\" %, Temp: \"); Serial.print(t); Serial.println(\" C\");",
          "  delay(2000);"
        ]
      },
      "4": {
        materials: "Required components:\nüîπ Arduino Uno\nüîπ Servo motor\nüîπ Jumper wires",
        steps: "Circuit:\n1Ô∏è‚É£ Servo signal to pin 9\n2Ô∏è‚É£ VCC to 5V\n3Ô∏è‚É£ GND to GND",
        code: [
          "// Servo Motor Example",
          "#include <Servo.h>",
          "Servo myServo;",
          "void setup() { myServo.attach(9); }",
          "void loop() { myServo.write(0); delay(1000); myServo.write(180); delay(1000); }"
        ]
      },
      "5": {
        materials: "Required components:\nüîπ Arduino Uno\nüîπ 16x2 LCD\nüîπ Potentiometer\nüîπ Jumper wires",
        steps: "Circuit:\n1Ô∏è‚É£ Connect LCD pins RS, E, D4-D7 to Arduino\n2Ô∏è‚É£ Potentiometer to adjust contrast",
        code: [
          "// LCD Display Example",
          "#include <LiquidCrystal.h>",
          "LiquidCrystal lcd(12, 11, 5, 4, 3, 2);",
          "void setup() { lcd.begin(16, 2); lcd.print(\"Hello, World!\"); }",
          "void loop() { }"
        ]
      }
    };

    const p = details[choice];
    if (!p) {
      await slowPrint("Sorry, that option is not available yet. üòî");
      return;
    }

    await slowPrint(p.materials);
    await slowPrint(p.steps);
    await slowPrint("Here is your Arduino code:");
    for (const line of p.code) {
      await slowPrint(line, 50);
    }

    await slowPrint("Do you need help with anything else? üòä");
    state.step = 2;
  }

  askIdeStatus();
</script>

</body>
</html>
